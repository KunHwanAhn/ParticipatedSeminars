# React Native Webview를 사용해서 React로만 앱 만들기(+ CI/CD)
- 윤창현 @ granter
- [youtube](https://www.youtube.com/watch?v=Ecg52wAlYus)
- [Meeup](https://www.meetup.com/awskrug/events/294453954)

## Native App

### iOS
- 귀한 iOS 개발자
- 폐쇄적인 개발 환경
- 까다로운 App Store Review

### Android
- ???

## Cross Platform Framework

### React Native
- 웹 개발자가 가장 작업하기 쉬움
- 자칫하면 프로젝트가 매우 무거워짐
   - 이미지를 넣거나 하면... 점점 커짐

### Flutter
- 언어의 장벽(Dart)
- 국내시장 및 커뮤니티는 아직...
- 구글에서 직접적으로 지원하는, 필요하면 구글에서 기능을 넣음

## Hybrid App
- 네이티브 앱과 웹 앱의 장점을 합친 앱
- 화면이나 기능은 웹 + 하드웨어 기능을 위한 네이티브 앱

## 개발자 관점에서의 장/단점

### 단점
- UI/UX
   - 사용자가 앱을 보기 떄문에 앱에서 기대하는 UI/UX
   - 앱 자체의 네비게이션 효과 지원이 어려움
   - Pull to refresh 지원도 고려
- 앱과 웹을 같이 봐야함
   - 개발자 도구도 띄우고, 가상 시뮬레이터도 띄우고... 개발이 복잡
- 인프라가 복잡해짐
   - 네이티브 앱이라면 앱 배포하면 끝인데, 웹앱은 배포 파이프라인을 구축해야 함

### 장점
- 웹 개발자가 기존에 하던 것 그대로 하면 됨
   - 반대로 웹 개발자가 앱도 고민해야 할수도 있음
- 똑같은 코드인데 iOS와 Android 자체 UI가 달라서 다른 UI가 나올 수 있다
- 웹만 배포하면 바로 확인이 가능함

## 유저 관점에서의 장/단점

### 단점
- 네트워크의 영향이 매우 큼
   - 우리 나라 인터넷이 빠르다고 하지만, 유저들이 데이터를 다 써서 속도 제한이 걸린 케이스
- 좋은 UI, 나쁜 UX
   - 네이티브의 Long Press UX 대응이 어려움

### 장점
- 자동 업데이트
- 가벼운 앱 사이즈
   - 웹뷰를 띄우기 위한 정도의 코드만 있어도 됨
- 유저가 수월하게 복사/붙여넣기가 가능하다
- PC와 동일한 경험
   - 반응형 웹 페이지라면

## 하이브리드 앱으로 잘 사용하는 곳들
- [펫 프렌즈](https://m.pet-friends.co.kr)
- [당근 마켓](https://www.daangn.com)
- [강남 언니](https://www.gangnamunni.com/)


## 중간 Q&A
- 코드 푸시라는 선택지는?
   - 간헐적으로 서버에서 코드 푸시가 안되는 케이스가 있음
   - 앱을 갈아끼우는 동안 장애가 날 수 있음
   - 마켓에서 앱을 리뷰하는 중에 코드 푸시가 일어나면 심사가 거절될 수 있음
   - 네이티브에서 필요한 변경
- 네이티브를 업그레이드 하지않는 사용자는?
   - UX/UI 레벨에서 강제 업데이트 알림을 주는 방식이 있을 것 같다
   - 쓸 것 같은 기능은 웬만해서는 네이티브 앱에 미리 넣어놓는다
- 안드로이드 네이티브 뒤로가기 같은 처리는?
   - 네이티브 앱에서 강제로 해야 한다
- 스택 스크린이라는 기법도 있다
   - 스택 스크린이 정말 좋은 UX일까?
   - 리액트 네이티비를 쓴다면 리액트 네비게이션을 많이 쓴다
   - 우리는 고객의 UX를 먼저 고민하는 것이 좋지 않을까?

## React Native 개발 가이드

### SplashScreen
- 앱 자체의 리소스를 사용하는 것이 아니라, 웹을 불러오는 것
- 웹 페이지를 불러오기 때문에 한 순간에 하얀 화면이 보일 수 있음
- 로띠로 애니메이션을 보여줘서 고객이 기다리는 시간을 맞춰주면서 고객 경험을 개선하는 것을 고민하고 있음

### Web <-> App 통신
- Query String을 사용하여 통신
- `postMessage()` & `onMessage` Handler
   - Android와 iOS의 글로벌 객체 생성 위치가 다름
   - iOS는 window
   - Android는 document

### Fallback
   - 웹앱을 배포하면 자동으로 업데이트가 되는데, 이로 인해서 기존 유저가 보던 라우트가 사라졌다면?
   - `onContentProcessDidTerminate` 이벤트로 fallback 처리

### OS별 대응
- iOS와 input
    - 16글자 이하인 경우 자기 맘대로 화면을 확대하고 줄이는 현상이 발생할 수 있음
- 간편로그인, 소셜로그인도 환경별로 대응 고민

## CI/CD

### AWS Amplify
- 간편한 사용
   - 레포지토리와 연동만하면 알아서 잘 해줌
- 확장성, 가용성
   - 완전 관리형 서비스로 자체적으로 모니터링, 로드밸런싱, 보안, CDN, SSL 등등 알아서 함
- 프리티어
   - 12개월 제한된 리소스 안에서 무료 사용 가능
- 자체 도메인 제공
   - 도메인을 구매하지 않아도 자체 생성된 도메인 제공

### AWS App Runner
- Amplify의 커스터마이징 가능 버전
- AWS Amplify와 EC2에 직접 CI/CD 세팅하는 것의 중간
- 간편한 배포
   - 컨테이너 이미지만 업로드하면 잘 해줌
- 확장성, 가용성
   - 컨테이너 완전 관리형 서비스로 자체적으로 모니터링
   - 로드밸런싱, 보안, CDN 등등 알아서 함
- 저렴한 비용 - 딱 쓴 만큼만 내면 됨

### Vercel
- 간편한 사용
   - 레포지토리와 연동만하면 알아서 잘 해줌
- 확장성, 가용성
   - 완전 관리형 서비스로 자체적으로 모니터링, 로드밸런싱, 보안, CDN, SSL 등등 알아서 함
- 프리티어
   - 깃험 조직을 사용하지 않거나 유저가 적다면 무료일지도... PRO 플랜은 다소 부담스러운 가격
- 자체 도메인 제공
   - 도메인을 구매하지 않아도 자체 생성된 도메인 제공

### 사소한 팁
- CI/CD에서 조직에 속해서 쓰다보면 돈을 내야 하는데, netlify를 사용하면 회피할 수 있음.


## Apple App Store Review
- 악명높은 갑 오브 갑
- 기존 웹이랑 다른게 뭐냐?
   - 다른 것이 없다면 Reject함
   - Native Push만 연동하면 Reject 할 가능성이 낮음
- 권한 받는 이유 상세하게 써라
   - e.g. 사진 권한이 있다면? 그 사진 어느 목적으로 쓰는데?
   - e.g. 위치 권한이 있다면? 그 위치 어느 목적으로 쓰는데?
- 유저의 네트워크가 불안정한 경우 핸들링 처리해야 한다
- 커뮤니티가 있다면, 숨김, 차단, 신고기능, 탈퇴 넣어라
- 소셜로그인 넣을거면 애플 꼭 넣어라
   - 애플 로그인할 때도 연동이 잘 안되어 있다면, Reject 될수도
- Apple로 시작하기면 원터치 로그인 되어야지 추가정보 왜 받음?
- 개발, 테스트, 준비 중 등등 테스트성 단어 있으면 Reject
- 심사 중인데 배포해서 깜빡거림
- 스토어 이미지가 마켓 기준에 안 맞음
- 휴먼 인터페이스 가이드라인 준수 여부 확인 필수
- 로그인 기능이 있다면 테스트 계정 관리도 필수
- 이 외 다수...

## Q&A
- 리액트 네이티브의 3rd Party 라이브러리 의존성 문제 해결은 어떻게 하나요?
   - 업데이트를 할 때마다 긴장해야 합니다.
   - 항상 실패를 염두에 두고 있어야 하고, xcode 버전 올라갈 때 계속 업데이트를 따라가야 함
   - 답이 없음...
- Test Flight를 안 쓸 수 있는가?
   - 어쩔 수 없다, 써야 한다.
